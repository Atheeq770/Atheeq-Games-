<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Atheeq Games â€” Sussy Question (Spy Show)</title>
<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700;900&display=swap" rel="stylesheet">

<style>
/* ============================================================
   ROOT THEME VARIABLES â€” SPY SHOW + FUN COLORFUL DESIGN
============================================================ */
:root{
  --bg:#071022;
  --card:#0e2433;
  --primary:#FFD93D;
  --accent:#2DE2E6;
  --pink:#FF4D8C;
  --lime:#9EF01A;
  --text:#E0E1DD;
  --mute:#9aa4b2;
  --glass:rgba(255,255,255,0.03);
  --max-w:500px;
}

/* ============================================================
   BASE STYLES
============================================================ */
*{box-sizing:border-box;}
html,body{
  height:100%;
  margin:0;
  font-family:"Rubik",system-ui;
  background:linear-gradient(120deg,#083048,#071022);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
}

.container{
  width:100%;
  max-width:var(--max-w);
  margin:0 auto;
  padding:16px;
}

/* ============================================================
   HEADERS + LOGO
============================================================ */
.header{
  display:flex;
  align-items:center;
  gap:12px;
  margin-bottom:24px;
}
.logo{
  width:48px;
  height:48px;
  border-radius:50%;
  background:var(--accent);
  display:flex;
  justify-content:center;
  align-items:center;
  color:#000;
  font-weight:700;
}
.title-block h1{
  font-size:22px;
  margin:0;
  font-weight:800;
}
.title-block small{
  color:var(--mute);
}

/* ============================================================
   CARDS & INPUTS
============================================================ */
.card{
  background:var(--card);
  padding:16px;
  margin-bottom:18px;
  border-radius:14px;
  box-shadow:0 10px 22px rgba(0,0,0,0.3);
}

.card h2{
  margin-top:0;
  font-size:18px;
  font-weight:700;
}

input, textarea, select{
  width:100%;
  padding:10px;
  border-radius:8px;
  border:none;
  margin-top:6px;
  background:var(--glass);
  color:var(--text);
}

.btn{
  padding:12px 20px;
  border-radius:10px;
  background:var(--primary);
  color:#000;
  border:none;
  font-weight:700;
  cursor:pointer;
  margin:6px 0;
}
.btn-pink{ background:var(--pink); color:#fff; }
.btn-accent{ background:var(--accent); color:#000; }

/* ============================================================
   AVATARS
============================================================ */
.avatars{
  display:flex;
  gap:8px;
  margin-top:10px;
}
.avatar{
  width:40px;
  height:40px;
  border-radius:50%;
  background:#222;
  display:flex;
  justify-content:center;
  align-items:center;
  font-weight:700;
  color:#fff;
  transition:transform 0.2s, box-shadow 0.2s;
}
.avatar.bounce{ transform:translateY(-4px); box-shadow:0 0 10px var(--primary); }
.avatar.pulse{ box-shadow:0 0 12px var(--accent); }

/* ============================================================
   STICKY BOTTOM BAR
============================================================ */
.sticky{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  background:#0005;
  backdrop-filter:blur(10px);
  display:flex;
  justify-content:center;
  padding:16px;
}
.sticky-btn{
  width:var(--max-w);
  padding:14px;
  border-radius:12px;
  border:none;
  font-weight:700;
  background:var(--primary);
  color:#000;
  cursor:pointer;
}

/* ============================================================
   MODAL FIXED (always works)
============================================================ */
.modal{
  position:fixed;
  inset:0;
  background:#0009;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
  visibility:hidden;
}
.modal.active{ visibility:visible; }
.modal-card{
  background:var(--card);
  padding:20px;
  border-radius:16px;
  width:90%;
  max-width:380px;
}
.modal-card button{
  margin-top:16px;
  width:100%;
}

.hidden{ display:none; }

</style>
</head>

<body>
<div class="container">

<!-- ============================================================
     HEADER
============================================================ -->
<div class="header">
  <div class="logo">AG</div>
  <div class="title-block">
    <h1>Atheeq Games</h1>
    <small>Sussy Question â€” Spy Show Edition</small>
  </div>
</div>

<!-- ============================================================
     SETUP SCREEN
============================================================ -->
<div id="setupScreen">

  <div class="card">
    <h2>Number of players (5â€“10)</h2>
    <input type="number" id="playerCount" min="5" max="10" value="6">
  </div>

  <div class="card">
    <h2>Words</h2>
    <textarea id="wordList" rows="2">Birthday,Toothbrush,Laptop,Wallet,Charger,Watch</textarea>
    <button class="btn-accent" id="randomizeWords">Randomize</button>
  </div>

  <div class="card">
    <h2>Ask Rules</h2>
    <label>Minimum asks per player</label>
    <input type="number" id="minAsks" value="1">
    <label>Total turns (0 = auto)</label>
    <input type="number" id="totalTurns" value="0">
  </div>

  <div class="card">
    <h2>Prompts</h2>
    <textarea id="prompts" rows="2">How often do you use it?,Can it fit in a pocket?,Is it expensive?,Would you take it outside?,Does it make noise?</textarea>
  </div>

  <button class="btn" id="startGame">Start Game</button>

</div><!-- end setup -->


<!-- ============================================================
     REVEAL SCREEN
============================================================ -->
<div id="revealScreen" class="hidden card">
  <h2 id="revealTitle">Player 1 â€” Tap to reveal</h2>
  <button class="btn-pink" id="tapReveal">Reveal</button>
  <button class="btn" id="nextReveal">Next</button>
</div>

<!-- ============================================================
     ASK PHASE
============================================================ -->
<div id="askScreen" class="hidden card">
  <h2 id="askHeader">Ask Phase</h2>
  <div id="askPrompt" style="margin-bottom:14px;"></div>
  <div class="avatars" id="avatarRow"></div>
</div>

<!-- ============================================================
     VOTE SCREEN
============================================================ -->
<div id="voteScreen" class="hidden card">
  <h2>Vote the Odd One</h2>
  <div class="avatars" id="voteRow"></div>
</div>

</div><!-- end container -->

<!-- ============================================================
     STICKY FOOTER
============================================================ -->
<div class="sticky">
  <button class="sticky-btn" id="stickyAction">Next</button>
</div>

<!-- ============================================================
     MODAL (fixed + safe)
============================================================ -->
<div id="modal" class="modal">
  <div class="modal-card">
    <div id="modalContent"></div>
    <button class="btn" id="modalOk">OK</button>
  </div>
</div>

<!-- ============================================================
     SCRIPT â€” FIXED & OPTIMIZED
============================================================ -->
<script>
const setup = $('#setupScreen');
const reveal = $('#revealScreen');
const ask = $('#askScreen');
const vote = $('#voteScreen');

const modal = $('#modal');
const modalContent = $('#modalContent');
const modalOk = $('#modalOk');

const stickyAction = $('#stickyAction');

const playerCountEl = $('#playerCount');
const wordListEl = $('#wordList');
const promptsEl = $('#prompts');
const minAsksEl = $('#minAsks');
const totalTurnsEl = $('#totalTurns');

const tapRevealBtn = $('#tapReveal');
const nextRevealBtn = $('#nextReveal');

const askHeader = $('#askHeader');
const askPrompt = $('#askPrompt');
const avatarRow = $('#avatarRow');
const voteRow = $('#voteRow');

function $(q){ return document.querySelector(q); }

/* ============================================================
   GAME STATE
============================================================ */
let state = {
  n:6,
  words:[],
  prompts:[],
  revealIndex:0,
  oddIndex:0,
  assignments:[],
  askTurns:0,
  totalTurns:0,
  askedCounts:[],
};

/* ============================================================
   START GAME SETUP
============================================================ */
$('#startGame').onclick = ()=>{
  state.n = +playerCountEl.value;
  state.words = wordListEl.value.split(',').map(w=>w.trim()).filter(Boolean);
  state.prompts = promptsEl.value.split(',').map(w=>w.trim()).filter(Boolean);

  const minAsk = +minAsksEl.value || 1;
  let T = +totalTurnsEl.value;
  if(!T || T<=0) T = minAsk * state.n;
  state.totalTurns = T;

  state.revealIndex = 0;
  state.askTurns = 0;
  state.askedCounts = Array(state.n).fill(0);

  // assign odd word
  state.oddIndex = Math.floor(Math.random()*state.n);
  state.assignments = [];
  for(let i=0;i<state.n;i++){
    state.assignments.push(i===state.oddIndex ? state.words[0] : state.words[1]);
  }

  setup.classList.add('hidden');
  reveal.classList.remove('hidden');

  updateRevealUI();
};

/* ============================================================
   REVEAL PHASE
============================================================ */
function updateRevealUI(){
  tapRevealBtn.textContent = "Reveal";
  $('#revealTitle').textContent = `Player ${state.revealIndex+1} â€” Tap to reveal`;
}

tapRevealBtn.onclick = ()=>{
  tapRevealBtn.textContent = state.assignments[state.revealIndex];
};

nextRevealBtn.onclick = ()=>{
  state.revealIndex++;
  if(state.revealIndex >= state.n){
    reveal.classList.add('hidden');
    startAskPhase();
    return;
  }
  updateRevealUI();
};

/* ============================================================
   ASK PHASE
============================================================ */
function startAskPhase(){
  ask.classList.remove('hidden');
  buildAvatars();
  stickyAction.textContent = "Next Ask";
}

function buildAvatars(){
  avatarRow.innerHTML='';
  for(let i=0;i<state.n;i++){
    const a = document.createElement('div');
    a.className='avatar';
    a.textContent = i+1;
    avatarRow.appendChild(a);
  }
}

function choosePair(){
  let a = Math.floor(Math.random()*state.n);
  let t = Math.floor(Math.random()*state.n);
  while(t===a) t = Math.floor(Math.random()*state.n);
  return {asker:a, target:t};
}

stickyAction.onclick = ()=>{
  if(ask.classList.contains('hidden')) return;

  if(state.askTurns >= state.totalTurns){
    if(state.askTurns>0) endAskPhase();
    return;
  }

  const p = choosePair();
  state.askedCounts[p.asker]++;
  state.askTurns++;

  const prompt = state.prompts[Math.floor(Math.random()*state.prompts.length)];
  askPrompt.textContent = `Player ${p.asker+1} â†’ Player ${p.target+1}: ${prompt}`;

  highlightAvatars(p.asker,p.target);

  if(state.askTurns >= state.totalTurns){
    setTimeout(endAskPhase,200);
  }
};

function highlightAvatars(a,t){
  [...avatarRow.children].forEach((el,i)=>{
    el.classList.remove('bounce','pulse');
    if(i===a) el.classList.add('bounce');
    if(i===t) el.classList.add('pulse');
  });
}

/* ============================================================
   END ASK PHASE â†’ VOTE
============================================================ */
function endAskPhase(){
  ask.classList.add('hidden');
  showModal("Ask phase completed! Vote who you think is the odd one.");
  buildVote();
}

function buildVote(){
  voteRow.innerHTML='';
  for(let i=0;i<state.n;i++){
    const v = document.createElement('div');
    v.className='avatar';
    v.textContent = i+1;
    v.onclick = ()=> revealResult(i);
    voteRow.appendChild(v);
  }
  vote.classList.remove('hidden');
  stickyAction.textContent = "Waitingâ€¦";
  stickyAction.disabled = true;
}

/* ============================================================
   REVEAL RESULT
============================================================ */
function revealResult(voteIndex){
  let msg = (voteIndex === state.oddIndex)
    ? `Correct! Player ${voteIndex+1} was the LIAR! ðŸŽ‰`
    : `Wrong! The liar was Player ${state.oddIndex+1}.`;

  showModal(msg);
}

/* ============================================================
   MODAL HANDLING (FIXED)
============================================================ */
function showModal(msg){
  modalContent.innerHTML = msg;
  modal.classList.add('active');
}
modalOk.onclick = ()=> modal.classList.remove('active');
modal.onclick = (e)=>{ if(e.target===modal) modal.classList.remove('active'); };

/* ============================================================
   RANDOM WORD BUTTON
============================================================ */
$('#randomizeWords').onclick = ()=>{
  const sample = ["Phone","Bottle","Shoes","Keys","Pillow","Mirror","Ring","Earbuds","TV","Pen"];
  let w1 = sample[Math.floor(Math.random()*sample.length)];
  let w2 = sample[Math.floor(Math.random()*sample.length)];
  while(w2===w1) w2 = sample[Math.floor(Math.random()*sample.length)];
  wordListEl.value = `${w1},${w2}`;
};
</script>
</body>
</html>
